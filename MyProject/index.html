<!DOCTYPE html>
<html lang="ar" dir="rtl" id="main-html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>29 Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @font-face { font-family: 'MyFont'; src: url('./assets/font.ttf'); }
        * { font-family: 'MyFont', sans-serif !important; -webkit-tap-highlight-color: transparent; }
        body { background-color: #000; color: white; margin: 0; overflow-x: hidden; }
        
        .page { position: fixed; inset: 0; background: #000; z-index: 10; overflow-y: auto; padding-bottom: 110px; }
        .page-hidden { display: none !important; }

        /* Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± */
        #hero-slider { height: 60vh; position: relative; overflow: hidden; }
        .slide { position: absolute; inset: 0; opacity: 0; transition: opacity 1s ease; background-size: cover; background-position: top; }
        .slide.active { opacity: 1; }
        .slide-overlay { position: absolute; inset: 0; background: linear-gradient(to top, #000, transparent 80%); }

        /* Ø§Ù„Ø¨ÙˆØ³ØªØ±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .movie-scroll { display: flex; overflow-x: auto; gap: 8px; padding: 0 20px; scrollbar-width: none; }
        .movie-card { min-width: 85px; flex-shrink: 0; cursor: pointer; }
        .movie-card img { width: 85px; height: 130px; border-radius: 10px; object-fit: cover; border: 1px solid #222; }

        /* Ø§Ù„Ø¨Ø­Ø« 4 ÙÙŠ Ø§Ù„ØµÙ */
        .search-grid { display: grid; grid-template-cols: repeat(4, 1fr); gap: 6px; padding: 10px; }
        .search-item img { width: 100%; height: 110px; border-radius: 8px; object-fit: cover; border: 1px solid #1a1a1a; }
        .search-item p { font-size: 7px; margin-top: 4px; color: #a1a1aa; text-align: center; font-weight: bold; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }

        /* Ø¥Ø¨Ø±Ø§Ø¡ Ø§Ù„Ø°Ù…Ø© */
        #disclaimer-page { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 10000; display: none; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(10px); }

        /* Ù†ÙŠÙØ¨Ø§Ø± */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); display: flex; justify-content: space-around; padding: 15px; border-top: 1px solid #111; z-index: 4000; }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 11px; opacity: 0.4; cursor: pointer; }
        .nav-item.active { opacity: 1; }

        /* ØµÙØ­Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ù…Ø´ØºÙ„ */
        #details-page { position: fixed; inset: 0; background: #000; z-index: 5000; display: none; overflow-y: auto; }
        #video-container { position: fixed; inset: 0; background: #000; z-index: 6000; display: none; }
        iframe { width: 100%; height: 100%; border: none; }

        .popup-slider { position: fixed; bottom: -100%; left: 0; right: 0; background: #111; z-index: 7000; transition: 0.4s; border-radius: 30px 30px 0 0; padding: 25px; border-top: 1px solid #222; }
        .popup-slider.active { bottom: 0; }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 6500; display: none; backdrop-filter: blur(8px); }
    </style>
</head>
<body>

    <div id="auth-page" class="fixed inset-0 bg-black z-[9000] flex flex-col items-center justify-center p-8">
        <div class="w-20 h-20 bg-white text-black rounded-[25px] flex items-center justify-center font-black text-3xl mb-10">29</div>
        <div class="w-full max-w-sm space-y-4 text-center">
            <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="w-full bg-zinc-900 p-4 rounded-2xl outline-none border border-zinc-800 focus:border-white">
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±" class="w-full bg-zinc-900 p-4 rounded-2xl outline-none border border-zinc-800 focus:border-white">
            <button id="login-btn" class="w-full bg-white text-black p-4 rounded-2xl font-black">Ø¯Ø®ÙˆÙ„</button>
            <button class="w-full text-zinc-400 text-sm py-1 underline">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ ØŸ Ø§Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
            <button id="google-btn" class="w-full bg-zinc-800 p-4 rounded-2xl flex items-center justify-center gap-3 font-bold border border-zinc-700">
                <img src="https://www.google.com/favicon.ico" class="w-4"> Google
            </button>
        </div>
    </div>

    <div id="disclaimer-page">
        <div class="bg-zinc-900 p-8 rounded-[30px] border border-zinc-800 w-full max-w-sm text-center shadow-2xl">
            <h3 class="text-xl font-black mb-4 text-red-500">ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø¨Ø±Ø§Ø¡ Ø°Ù…Ø©</h3>
            <p class="text-zinc-400 text-sm mb-8 leading-relaxed">Ø§Ù†Ø§ Ø§Ø¨Ø±ÙŠ Ø°Ù…ØªÙŠ Ø§Ù…Ø§Ù… Ø§Ù„Ù„Ù‡ ÙÙŠ Ø­Ø§Ù„ Ù…Ø´Ø§Ù‡Ø¯ØªÙƒ Ø§ÙÙ„Ø§Ù… ØªØ®Ù„ Ø§Ù„Ø§Ø¯Ø¨</p>
            <div class="flex items-center justify-center gap-3 mb-8">
                <input type="checkbox" id="agree-check" class="w-5 h-5 accent-white">
                <label for="agree-check" class="text-sm font-bold">Ù‡Ù„ Ù…Ø³ØªØ¹Ø¯ Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ù‡ØŸ</label>
            </div>
            <button onclick="enterSite()" id="dis-btn" disabled class="w-full bg-white text-black p-4 rounded-2xl font-black opacity-30 transition-all">Ù…ÙˆØ§ÙÙ‚</button>
        </div>
    </div>

    <div id="overlay" onclick="closeAllPopups()"></div>

    <div id="video-container">
        <button onclick="closeVideo()" class="absolute top-10 right-6 z-[7000] bg-white text-black px-4 py-2 rounded-full font-bold">Ø¥ØºÙ„Ø§Ù‚ X</button>
        <iframe id="video-player" src="" allowfullscreen></iframe>
    </div>

    <div id="home-page" class="page page-hidden">
        <div id="hero-slider"></div>
        <div id="home-sections" class="mt-8 space-y-10"></div>
    </div>

    <div id="search-page" class="page page-hidden p-6 pt-12">
        <div class="bg-zinc-900 rounded-2xl p-4 flex items-center mb-4 border border-zinc-800">
            <input id="search-input" type="text" class="bg-transparent w-full outline-none text-start px-2" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£ÙÙ„Ø§Ù… ÙˆÙ…Ø³Ù„Ø³Ù„Ø§Øª...">
            <span>ğŸ”</span>
        </div>
        <div id="search-results" class="search-grid"></div>
    </div>

    <div id="details-page">
        <div id="det-hero" class="h-[45vh] bg-cover bg-top relative">
            <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent"></div>
            <button onclick="closeDetails()" class="absolute top-10 left-6 w-10 h-10 bg-black/50 rounded-full flex items-center justify-center text-xl">âœ•</button>
        </div>
        <div class="p-6 relative z-10 -mt-12">
            <h1 id="det-title" class="text-2xl font-black mb-4"></h1>
            <button id="play-now-btn" class="w-full bg-white text-black py-4 rounded-2xl font-black text-lg flex items-center justify-center gap-2 mb-6 active:scale-95 transition-all">
                <span>â–¶</span> Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¢Ù†
            </button>
            <p id="det-desc" class="text-zinc-400 text-sm leading-relaxed mb-6"></p>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="navTo('home-page', this)"><span>ğŸ </span><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
        <div class="nav-item" onclick="navTo('search-page', this)"><span>ğŸ”</span><span>Ø§Ù„Ø¨Ø­Ø«</span></div>
        <div class="nav-item" onclick="navTo('account-page', this)"><span>ğŸ‘¤</span><span>Ø­Ø³Ø§Ø¨ÙŠ</span></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD-FOwFAgCPl-CmMc-xAd2iZSxiScGkIss",
            authDomain: "myprojact-1f481.firebaseapp.com",
            projectId: "myprojact-1f481",
            storageBucket: "myprojact-1f481.firebasestorage.app",
            messagingSenderId: "916298884479",
            appId: "1:916298884479:web:12fe7d5937a683f10e64a"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();
        const TMDB_KEY = "abe00161eae53ce0b4f5bcefc1652fbc";

        // Ø£Ø­Ø¯Ø§Ø« Firebase
        document.getElementById('login-btn').onclick = () => signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('pass').value).catch(e => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"));
        document.getElementById('google-btn').onclick = () => signInWithPopup(auth, provider);
        window.signOutUser = () => signOut(auth).then(() => location.reload());

        // Ù…Ù†Ø·Ù‚ Ø¥Ø¨Ø±Ø§Ø¡ Ø§Ù„Ø°Ù…Ø©
        document.getElementById('agree-check').onchange = (e) => {
            const btn = document.getElementById('dis-btn');
            btn.disabled = !e.target.checked;
            btn.style.opacity = e.target.checked ? "1" : "0.3";
        };
        window.enterSite = () => {
            document.getElementById('disclaimer-page').style.display = 'none';
            document.getElementById('home-page').classList.remove('page-hidden');
        };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-page').style.display = 'none';
                document.getElementById('disclaimer-page').style.display = 'flex';
                initApp();
            } else {
                document.getElementById('auth-page').style.display = 'flex';
                document.getElementById('home-page').classList.add('page-hidden');
            }
        });

        async function initApp() {
            const res = await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${TMDB_KEY}&language=ar-SA`);
            const data = await res.json();
            setupSlider(data.results.slice(0, 5));
            renderRow("Ø¯Ø±Ø§Ù…Ø§", 18);
            renderRow("Ø£ÙƒØ´Ù†", 28);
            renderRow("ÙƒÙˆÙ…ÙŠØ¯ÙŠØ§", 35);
        }

        function setupSlider(items) {
            const container = document.getElementById('hero-slider');
            container.innerHTML = items.map((m, i) => `
                <div class="slide ${i === 0 ? 'active' : ''}" style="background-image: url('https://image.tmdb.org/t/p/original${m.backdrop_path}')" onclick="openDetails('${m.id}', '${m.media_type}')">
                    <div class="slide-overlay"></div>
                    <div class="absolute bottom-10 w-full text-center px-6"><h2 class="text-2xl font-black">${m.title || m.name}</h2></div>
                </div>
            `).join('');
            let cur = 0; setInterval(() => {
                const s = document.querySelectorAll('.slide'); if(!s.length) return;
                s[cur].classList.remove('active'); cur = (cur+1)%s.length; s[cur].classList.add('active');
            }, 5000);
        }

        async function renderRow(title, gid) {
            const res = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${TMDB_KEY}&with_genres=${gid}&language=ar-SA`);
            const d = await res.json();
            const div = document.createElement('div');
            div.innerHTML = `<h3 class="font-bold px-6 mb-3 border-r-4 border-white pr-3">${title}</h3>
                <div class="movie-scroll no-scrollbar">${d.results.map(m => `
                <div class="movie-card" onclick="openDetails('${m.id}', 'movie')">
                    <img src="https://image.tmdb.org/t/p/w500${m.poster_path}">
                </div>`).join('')}</div>`;
            document.getElementById('home-sections').appendChild(div);
        }

        document.getElementById('search-input').oninput = async (e) => {
            const q = e.target.value; const resDiv = document.getElementById('search-results');
            if(q.length < 2) { resDiv.innerHTML = ''; return; }
            const r = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB_KEY}&query=${q}&language=ar-SA`);
            const d = await r.json();
            resDiv.innerHTML = d.results.map(m => `
                <div class="search-item" onclick="openDetails('${m.id}', '${m.media_type}')">
                    <img src="https://image.tmdb.org/t/p/w500${m.poster_path || m.backdrop_path}">
                    <p>${m.title || m.name}</p>
                </div>`).join('');
        };

        // ÙØªØ­ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ±Ø¨Ø· Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„
        window.openDetails = async (id, type) => {
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${TMDB_KEY}&language=ar-SA`);
            const d = await res.json();
            document.getElementById('det-hero').style.backgroundImage = `url('https://image.tmdb.org/t/p/original${d.backdrop_path}')`;
            document.getElementById('det-title').innerText = d.title || d.name;
            document.getElementById('det-desc').innerText = d.overview || "Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ";
            document.getElementById('details-page').style.display = 'block';
            
            // Ø±Ø¨Ø· Ø§Ù„Ø²Ø± Ø¨Ø§Ù„Ù…Ø´ØºÙ„
            document.getElementById('play-now-btn').onclick = () => {
                const videoUrl = type === 'movie' 
                    ? `https://vidsrc.me/embed/movie?tmdb=${id}` 
                    : `https://vidsrc.me/embed/tv?tmdb=${id}&sea=1&epi=1`;
                document.getElementById('video-player').src = videoUrl;
                document.getElementById('video-container').style.display = 'block';
            };
        };

        window.closeVideo = () => {
            document.getElementById('video-container').style.display = 'none';
            document.getElementById('video-player').src = '';
        };

        window.closeDetails = () => document.getElementById('details-page').style.display = 'none';
        window.navTo = (id, el) => {
            document.querySelectorAll('.page').forEach(p => p.classList.add('page-hidden'));
            document.getElementById(id).classList.remove('page-hidden');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        };
    </script>
</body>
</html>